{% extends 'patient/base.html' %}
{% load static %}

{% block body %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function () {
        $("#full_name").keyup(function () {
            validateName("#full_name", "#full_name_error");
        });

        $("#birth_date").change(function () {
            validateDate("#birth_date", "#birth_date_error");
        });

        $("#phone_number").keyup(function () {
            validatePhoneNumber("#phone_number", "#phone_number_error");
        });

        $("#gender").change(function () {
            validateGender("#gender", "#gender_error");
        });
    });

    // Validate Full Name
    function validateName(fieldId, errorId) {
        var name = $(fieldId).val();
        var lettersWithSpaces = /^[A-Za-z\s]+$/;
        var errorSpan = $(errorId);

        if (name.trim() === "") {
            errorSpan.text("Full Name is required");
        } else if (!lettersWithSpaces.test(name)) {
            errorSpan.text("Only alphabets and spaces are allowed");
        } else {
            errorSpan.text(""); // Clear the error message
        }
    }

    // Validate Date of Birth
    function validateDate(fieldId, errorId) {
        var dob = $(fieldId).val();
        var errorSpan = $(errorId);

        // You can add date validation logic here
        // For example, checking if the date is within a valid range
        // and formatting like yyyy-mm-dd
        if (dob.trim() === "") {
            errorSpan.text("Date of Birth is required");
        } else {
            errorSpan.text(""); // Clear the error message
        }
    }

    // Validate Phone Number
    function validatePhoneNumber(fieldId, errorId) {
        var phoneNumber = $(fieldId).val();
        var phoneRegex = /^\d{10}$/; // 10-digit phone number regex
        var errorSpan = $(errorId);

        if (!phoneRegex.test(phoneNumber)) {
            errorSpan.text("Invalid Phone Number. Please enter a 10-digit number.");
        } else {
            errorSpan.text(""); // Clear the error message
        }
    }

    // Validate Gender
    function validateGender(fieldId, errorId) {
        var gender = $(fieldId).val();
        var errorSpan = $(errorId);

        if (gender === "") {
            errorSpan.text("Gender is required");
        } else {
            errorSpan.text(""); // Clear the error message
        }
    }
</script>

<div class="container-fluid" style="padding-top: 20px">
    <div class="row">
        <div class="col-sm-4">
            <div class="card mb-3">
                <div class="card-header" style="background-color: #007bff; color: white; font-weight: bold; text-align: center;">
                    Complete Your Profile
                </div>
                <div class="card-body">
                    <form action="" method="POST">
                        {% csrf_token %}
                        <div class="form-group">
                            <label for="full_name">Full Name</label>
                            <input type="text" class="form-control" id="full_name" name="full_name" placeholder="Full Name">
                            <span id="full_name_error" style="color: red;"></span>
                        </div>
                        <div class="form-group">
                            <label for="birth_date">Date of Birth</label>
                            <input type="date" id="birth_date" class="form-control" name="birth_date" min="1950-01-01" max="2023-09-12" required>
                            <span id="birth_date_error" style="color: red;"></span>
                        </div>
                        <div class="form-group">
                            <label for="gender">Gender</label>
                            <select class="form-control" id="gender" name="gender">
                                <option value="">Select Your Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                            </select>
                            <span id="gender_error" style="color: red;"></span>
                        </div>
                        <div class="form-group">
                            <label for="phone_number">Phone Number</label>
                            <input type="text" class="form-control" id="phone_number" name="phone_number" placeholder="Phone Number">
                            <span id="phone_number_error" style="color: red;"></span>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn btn-primary btn-lg btn-block">Save</button>
                        </div>
                    </form>
                    {% if messages %}
                    <div class="messages">
                        {% for message in messages %}
                        <div class="alert alert-success">{{ message }}</div>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="col-sm-4"></div>
    </div>
</div>
</div>
</div>
{% endblock %}
